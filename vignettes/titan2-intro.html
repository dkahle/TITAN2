<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Matthew Baker (UMBC), Ryan King (Baylor), and David Kahle (Baylor)" />


<title>An Introduction to TITAN2</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">An Introduction to TITAN2</h1>
<h4 class="author"><em>Matthew Baker (UMBC), Ryan King (Baylor), and David Kahle (Baylor)</em></h4>
<h4 class="date"><em>Version 2.1</em></h4>



<div id="introduction-to-threshold-indicator-taxa-analysis-with-titan2" class="section level3">
<h3>Introduction to Threshold Indicator Taxa Analysis with <strong>TITAN2</strong></h3>
<p>The purpose of this vignette is to walk users through the basic functionality of the package <strong>TITAN2</strong> for analysis of taxon-specific contributions to community change along an environmental gradient. The Everglades data for this vignette was described in <a href="http://onlinelibrary.wiley.com/doi/10.1111/j.2041-210X.2009.00007.x/full">Baker and King (2010)</a> first published by <a href="http://link.springer.com/article/10.1007/s00267-002-0036-4#/page-1">King and Richardson (2003)</a>.</p>
<p>For users familiar with the original version of <code>titan()</code> and associated functions, released as a text file for R 2.9.2 in Appendix 3 of [Baker and King (2010)] (<a href="http://onlinelibrary.wiley.com/doi/10.1111/j.2041-210X.2009.00007.x/full" class="uri">http://onlinelibrary.wiley.com/doi/10.1111/j.2041-210X.2009.00007.x/full</a>), there are a number of updates included in this R package <strong>TITAN2</strong>, some of which may break your code. First, the original scripts have been divided into modular component functions to facilitate dissemination through CRAN. Second, a number of functions have been added to reduce run time and allow for the handling of large datasets. Third, several new analyses and plotting functions have been included, and others dropped. Fourth, several minor bugs have been fixed; these include screens for inappropriate data.</p>
</div>
<div id="first-steps" class="section level3">
<h3>First Steps</h3>
<p>For users new to <strong>TITAN2</strong>, the package can be loaded like any other R package downloaded from CRAN with <code>install.packages(&quot;TITAN2&quot;)</code>; this only needs to be done once. The package can then be loaded into an active R session with <code>library()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;TITAN2&quot;</span>)</code></pre></div>
<p>Note that the package needs to be loaded once per R session.</p>
<p>As with the first version of the project, <code>titan()</code> requires 1) a site by taxa matrix and 2) an environmental gradient. To facilitate this discussion, we have included in <strong>TITAN2</strong> examples of both: the datasets <code>glades.taxa</code> and <code>glades.env</code>. This is the same data included with the original version in <a href="http://onlinelibrary.wiley.com/doi/10.1111/j.2041-210X.2009.00007.x/full">Baker and King (2010)</a>. Users can load the taxa data with the <code>data()</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(glades.taxa)
<span class="kw">str</span>(glades.taxa, <span class="dt">list.len =</span> <span class="dv">5</span>)
<span class="co"># 'data.frame': 126 obs. of  164 variables:</span>
<span class="co">#  $ ABLARHAM: num  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#  $ ACENTRIA: num  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#  $ ANOPHELE: num  0 0 0 0 0.802 ...</span>
<span class="co">#  $ APEDELAS: num  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#  $ APHAOPAC: num  0.382 0.802 1.294 0 0.564 ...</span>
<span class="co">#   [list output truncated]</span></code></pre></div>
<p><em>See below for a discussion of how you can get your data into R.</em></p>
<p>The <code>data()</code> function loads the site by taxa matrix of 126 rows and 164 columns <code>glades.taxa</code>, and the <code>str()</code> (“structure”) function gives a summary of what the data object is. The columns of <code>glades.taxa</code> contain <span class="math inline">\(log_{10}(x+1)\)</span> transformed densities of macroinvertebrate taxa (though transformation is usually unnecessary in <strong>TITAN2</strong>). The rows are sample units. Taxa names are 8-character abbreviations of scientific names. Only taxa with at least 5 occurrences are included. Taxa in your file must occur at least 3 times. Missing values are not allowed.</p>
<p>Loading the sample environmental gradient data is done similarly:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(glades.env)
<span class="kw">str</span>(glades.env)
<span class="co"># 'data.frame': 126 obs. of  1 variable:</span>
<span class="co">#  $ TP.ugL: num  41.2 41.8 43.6 40.1 43.6 43 43.6 36.5 34.1 56.4 ...</span></code></pre></div>
<p>This dataset has 126 rows and 1 column, surface-water total phosphorus (ug/L). As with the taxa data, missing values are not allowed in the environmental gradient data.</p>
<p>We are now ready to run the <code>titan()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">glades.titan &lt;-<span class="st"> </span><span class="kw">titan</span>(glades.env, glades.taxa)</code></pre></div>
<p>In the above use of <code>titan()</code> many parameters are set by default, but they can be customized to the user’s circumstance by direct specification. The default values assumed by the above call are</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">glades.titan &lt;-<span class="st"> </span><span class="kw">titan</span>(glades.env, glades.taxa, 
  <span class="dt">minSplt =</span> <span class="dv">5</span>, <span class="dt">numPerm =</span> <span class="dv">250</span>, <span class="dt">boot =</span> <span class="ot">TRUE</span>, <span class="dt">nBoot =</span> <span class="dv">500</span>, <span class="dt">imax =</span> <span class="ot">FALSE</span>, 
  <span class="dt">ivTot =</span> <span class="ot">FALSE</span>, <span class="dt">pur.cut =</span> <span class="fl">0.95</span>, <span class="dt">rel.cut =</span> <span class="fl">0.95</span>, <span class="dt">ncpus =</span> <span class="dv">1</span>, <span class="dt">memory =</span> <span class="ot">FALSE</span>
)</code></pre></div>
<p><code>titan()</code>’s extensive computations often require long run times, typically minutes or hours depending on the specifications. To save you some time from running the above function yourself, we’ve included the results in the built-in dataset <code>glades.titan</code>, accessible with the <code>data()</code> function as before:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(glades.titan)</code></pre></div>
<p>In <code>titan()</code> the primary arguments are the environmental gradient (here <code>glades.env</code>) and the taxa matrix (here <code>glades.taxa</code>). When you use the function, be sure to save the output to another variable (this is the <code>glades.titan &lt;- titan(gla...</code> part above). Note that the deviance argument in <code>titan()</code> has been dropped from previous versions. Other arguments include the following; you can learn more about them in the documentation of <code>titan()</code> obtained by typing <code>?titan</code>:</p>
<ul>
<li><p><code>minSplt</code> - the minimum number of observations on either side of a change point required to compute IndVal, <span class="math inline">\(z\)</span> scores, and associated statistics. There are few reasons to make this value larger unless one is investigating sample bias. Although small data sets may require reducing <code>minSplt</code>, it should never be smaller than 3.</p></li>
<li><p><code>numPerm</code> - the number of random permutations of the taxa data used to compare observed IndVal scores to random ordering of observations along the environmental gradient, compute IndVal p-values (the probability that the magnitude of the observed value is no different from a distribution of those obtained via random permutation), and to calculate the mean and standard deviation necessary for computing <span class="math inline">\(z\)</span> scores. We recommend a minimum of 250 for this argument during data exploration, and higher numbers (e.g., 500 or 1000) for more formal analysis because larger numbers will result in convergence on a more precise <span class="math inline">\(z\)</span> score that will show less variation between runs. Larger values will increase computation time.</p></li>
<li><p><code>boot</code> - a logical <code>TRUE</code> or <code>FALSE</code> controlling whether the function will employ a bootstrap resampling procedure to estimate uncertainty associated with the sample. This is strongly recommended as the absence of the bootstrap results and associated diagnostics will almost certainly result in interpretive errors, and should not be called <strong>TITAN2</strong> (<a href="http://www.bioone.org/doi/abs/10.1899/12-142.1">Baker and King 2013</a>).</p></li>
<li><p><code>nBoot</code> - controls the number of new datasets created by resampling the observed data with replacement. Values &lt;500 can be used for exploration of large datasets to reduce computation time, but we recommend 500 or 1000 for formal analysis.</p></li>
<li><p><code>imax</code> - controls whether the IndVal maximum or the <span class="math inline">\(z\)</span>-score maximum (default and v1.0) is used to determine change points for each taxon. This argument is provided as an option for those users concerned about the effect of bias introduced by the permutation used to calculate <span class="math inline">\(z\)</span> scores (see <a href="http://www.bioone.org/doi/abs/10.1899/12-142.1">Baker and King 2013</a> for explanation). In practice, we have found that <span class="math inline">\(z\)</span>-score bias is rarely a concern with empirical biological survey data. Nevertheless, we provide the option because we are unable to anticipate the full range of applications users may require.</p></li>
<li><p><code>ivTot</code>- controls whether IndVal scores are computed by mean relative abundance across partitions (the default; after <a href="http://www.esajournals.org/doi/abs/10.1890/0012-9615(1997)067%5B0345:SAAIST%5D2.0.CO;2">Dufrene and Legendre 1997</a>) or relative abundance obtained by the ratio of summed abundance in each partition to the total. We have found that the latter is helpful for exploring the effects of extreme skew in samples along the environmental gradient, but do not generally recommend it.</p></li>
<li><p><code>pur.cut</code>- the cut off value that defines what is considered a pure response direction. The default (0.95) requires that 95% of the results from bootstrap replicates agree with the observed response direction. NOTE: it is possible for strong unimodal responses to produce high reliability and low purity.</p></li>
<li><p><code>rel.cut</code>- the cut off value that defines what is considered a reliable response magnitude. The default (0.95) requires that 95% of the results from bootstrap replicates have a IndVal p-value less than or equal to 0.05, indicating a response magnitude at a given change point location that differs significantly from what would expect from random permutation. Low reliability often indicates that resampling can produce sample distributions without a strong response signal, but this is not always the case.</p></li>
<li><p><code>ncpus</code>- controls the number of processing cores to which the bootstrap procedure is allocated. The default (1) processes each bootstrap replicate in sequence. If ncpus&gt;1 the replicates will be allocated to different cores and processed in parallel using the R package <strong>parallel</strong> (which comes with R). Parallel processing dramatically shortens run time and is recommended for most desktop applications as modern personal computers typically have 2-8 processing cores.</p></li>
<li><p><code>memory</code>- a logical indicating whether temporary files should be written to disk during processing of bootstrap replicates. Although this IO procedure can extend sequential processing time, its effects is negligible relative to parallelization, and we recommend it for data matrices larger than 250,000 elements (e.g., 500 sites by 500 taxa). Note that use of <code>memory = TRUE</code> results in the creation of a scratch directory within the local workspace called “temp.dir”&quot; containing the excess results from each bootstrap replicate necessary for accurate summary. These files may be saved or discarded following each program run.</p></li>
</ul>
<p>During normal program operation, the taxa dataset is screened to assess whether it is appropriate for <code>titan()</code> and the following messages are written to the screen:</p>
<pre><code># 100% occurrence detected 1 times (0.8% of taxa), use of TITAN less than ideal for this data type
# Taxa frequency screen complete</code></pre>
<p>The first screening checks for excessively rare or common taxa occurrences and returns a warning if 100% or below minimum number of occurrences are detected. In some cases where analysis would be nonsensical, <code>titan()</code> will end its run. The second screen checks to make sure the environmental gradient and the taxa matrix have the same number of records.</p>
<p>The next set of messages detail progress of the change point analysis computations on the observed data:</p>
<pre><code># Determining partitions along gradient
# Calculating observed IndVal maxima and class values
# Calculating IndVals using mean relative abundance
# Permuting IndVal scores
# IndVal $z$ score calculation complete
# Summarizing Observed Results
# Estimating taxa change points using z-score maxima</code></pre>
<p>The final message issued in a normal execution presents the progress of the bootstrap routine by counting off replicates (if <code>ncpus = 1</code>):</p>
<pre><code># Bootstrap resampling in sequence...
# 1
# 2
# 3</code></pre>
<p>or informing the user that the bootstrap is running in parallel (if <code>ncpus = 2</code> or greater):</p>
<pre><code># Bootstrap resampling in parallel using 2 CPUs...no index will be printed to screen</code></pre>
<p>This is the most computationally intensive step in the analysis. The Everglades dataset takes ~6-7 seconds per bootstrap replicate, depending on processor speed. Thus, 500 replicates take 3500 seconds or 58 minutes and ~60 minutes for the entire run. However, <code>ncpus = 2</code> cuts this time in half to about 32 min, and <code>ncpus = 4</code> lowers the time to about 15 min, etc. For initial explorations, users may consider setting <code>boot = FALSE</code>. However, we do not recommend any interpretation of graphical outputs or many tabular outputs until filtered by bootstrap diagnostics.</p>
<div id="note-on-loading-your-own-data" class="section level4">
<h4>Note on Loading Your Own Data</h4>
<p>As noted in the previous section, <code>titan()</code> requires two datasets: a site by taxa matrix and a environmental gradient dataset. The site by taxa matrix should ideally be of class <code>data.frame</code>, the standard data structure in R. These can be read into R in several ways, for example the <code>read.table()</code> or <code>read.csv()</code> functions. The <strong>readr</strong> package has other similar functions to help read data into R. The environmental gradient dataset can either be a <code>data.frame</code> object with one column or simply an atomic vector of class <code>numeric</code>. In addition to the the data-reading functions listed above, <code>scan()</code> can be helpful for reading data of this type into R. In addition to these, the <code>file.choose()</code> function allows users to select files interactively, which can help avoid pathing issues.</p>
</div>
</div>
<div id="tabular-results" class="section level3">
<h3>Tabular Results</h3>
<p>Community change points are returned automatically at the end of each <code>titan()</code> call, but these tabular sum(z) change point results are part of the titan object and may be called as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">glades.titan<span class="op">$</span>sumz.cp
<span class="co">#           cp    0.05  0.10  0.50   0.90  0.95</span>
<span class="co"># sumz-  14.75 13.2000 13.20 14.60 18.355 20.10</span>
<span class="co"># sumz+  32.45 21.6500 21.85 30.35 33.150 37.85</span>
<span class="co"># fsumz- 14.75 13.1500 13.20 14.70 18.550 19.90</span>
<span class="co"># fsumz+ 29.85 21.8975 28.10 30.10 32.750 33.70</span></code></pre></div>
<p>The columns include the observed change point (<code>cp</code>) defined by the sum(z) maximum and selected quantiles (0.05-0.95) of the change points determined by resampling the observed data.</p>
<p>Rows include the change points corresponding to declining or negatively responding taxa (sumz-), those corresponding to the increasing or positively responding taxa (sumz+), and the corresponding scores using filtered versions of both sums. Filtering is achieved by computing the sum(z) scores using only those taxa that are determined to be pure and reliable indicators. FIltered scores are sensitive to <code>pur.cut</code> and <code>rel.cut</code> arguments at the <code>titan()</code> function call. Filtered scores may be used as a check to indicate whether impure or unreliable indicator taxa are contributing substantially to the pattern of sum(z) scores (in this case they do not).</p>
<p>To obtain tabular results for individual taxa we can simply type <code>glades.titan$sppmax</code>. Since this is a <span class="math inline">\(164 \times 16\)</span> matrix, we use the <code>head()</code> function to just display the top to get a feel for the results:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(glades.titan<span class="op">$</span>sppmax)
<span class="co">#          ienv.cp zenv.cp freq maxgrp IndVal obsiv.prob zscore      5%</span>
<span class="co"># ABLARHAM    5.05   15.60   15      1  31.83      0.004   9.77  7.3475</span>
<span class="co"># ACENTRIA   14.10   14.60    7      1  14.24      0.004   4.99  9.3550</span>
<span class="co"># ANOPHELE  109.40   43.15   15      2  27.42      0.004   7.81 29.1175</span>
<span class="co"># APEDELAS   18.35   20.10    5      1   6.69      0.132   1.94 10.9000</span>
<span class="co"># APHAOPAC   39.55   39.55  104      1  66.05      0.004   8.80 32.2000</span>
<span class="co"># ARRENSP1   86.95   85.55    9      2  21.97      0.020   3.91 13.1500</span>
<span class="co">#             10%   50%    90%      95% purity reliability  z.median filter</span>
<span class="co"># ABLARHAM 10.235 15.80  20.10  21.6000  1.000       1.000 10.604653      1</span>
<span class="co"># ACENTRIA 10.900 14.55  28.05  28.5000  0.998       0.956  5.915082      1</span>
<span class="co"># ANOPHELE 32.200 43.45  69.70  83.8625  1.000       1.000  9.336369      2</span>
<span class="co"># APEDELAS 13.060 18.40  43.76  55.0000  0.844       0.520  2.565831      0</span>
<span class="co"># APHAOPAC 33.000 37.85  39.55  40.1000  0.998       1.000  9.246758      1</span>
<span class="co"># ARRENSP1 18.170 85.80 109.40 126.2000  0.960       0.812  4.716420      0</span></code></pre></div>
<p>The resulting table lists all taxa as rows and the columns are as follows:</p>
<ul>
<li><p><code>ienv.cp</code>- environmental change point for each taxon based on IndVal maximum (used if <code>imax = TRUE</code>)</p></li>
<li><p><code>zenv.cp</code>- environmental change point for each taxon based on z maximum (default, <code>imax = FALSE</code>)</p></li>
<li><p><code>freq</code>- number of non-zero abundance values per taxon</p></li>
<li><p><code>maxgrp</code>- 1 if z- (negative response); 2 if z+ (positive response)</p></li>
<li><p><code>IndVal</code>-<a href="http://www.esajournals.org/doi/abs/10.1890/0012-9615(1997)067%5B0345:SAAIST%5D2.0.CO;2">Dufrene and Legendre 1997</a> IndVal statistic, scaled 0-100%</p></li>
<li><p><code>obsiv.prob</code>- probability of an equal or larger IndVal from random permutation. This is an uncorrected value that doesn’t account for the analysis of multiple taxa in the same data set nor repeated estimates of across n partitions of the predictor (x value). To reiterated, this is <em>not</em> a valid test of indicator “significance”, nor have the authors ever advocated its use in this manner (see Baker and King 2010). The authors include it here only because it is used in the calculation of reliability, which assesses the effect of nBoot replicates on the <code>obsiv.prob</code>; reliability, when coupled with purity, is a defensible metric for identifying robust indicator taxa.</p></li>
<li><p><code>zscore</code>- IndVal <span class="math inline">\(z\)</span> score</p></li>
<li><p><code>5%</code>, <code>10%</code>, <code>50%</code>, <code>90%</code>, <code>95%</code>- change point quantiles among bootstrap replicates</p></li>
<li><p><code>purity</code> - proportion of replicates matching observed <code>maxgrp</code> assignment</p></li>
<li><p><code>reliability</code> - proportion of replicate <code>obsiv.prob</code> values &lt; = 0.05</p></li>
<li><p><code>z.median</code>- median score magnitude across all bootstrap replicates</p></li>
<li><p><code>filter</code>- logical (if &gt;0) indicating whether each taxa met purity and reliability criteria, value indicates <code>maxgrp</code> assignment.</p></li>
</ul>
<p>Remember that each <code>titan</code> object (created with the <code>titan()</code> function) contains a number of additional elements for post hoc exploration:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(glades.titan, <span class="dt">max.level =</span> <span class="dv">1</span>, <span class="dt">give.attr =</span> <span class="ot">FALSE</span>)
<span class="co"># List of 13</span>
<span class="co">#  $ sppmax     : num [1:164, 1:16] 5.05 14.1 109.4 18.35 39.55 ...</span>
<span class="co">#  $ sumz.cp    : num [1:4, 1:6] 14.8 32.5 14.8 29.9 13.2 ...</span>
<span class="co">#  $ env        : num [1:126, 1] 41.2 41.8 43.6 40.1 43.6 43 43.6 36.5 34.1 56.4 ...</span>
<span class="co">#  $ taxa       : num [1:126, 1:164] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#  $ envcls     : num [1:117] 3.5 4.8 5.3 6.1 6.5 6.5 6.5 6.8 7.2 7.3 ...</span>
<span class="co">#  $ srtEnv     : num [1:126] 2.5 3.3 3.5 3.5 3.5 4.8 5.3 6.1 6.5 6.5 ...</span>
<span class="co">#  $ ivzScores  : num [1:656, 1:117] 1 2 2 2 2 2 2 1 2 2 ...</span>
<span class="co">#  $ ivz        : num [1:117, 1:2] 99.3 121.4 133.8 131.8 123.8 ...</span>
<span class="co">#  $ ivz.f      : num [1:117, 1:2] 88.8 113.4 123.3 125.2 113.2 ...</span>
<span class="co">#  $ maxSumz    : num [1:500, 1:2] 15.1 15.4 16.9 15.4 14.6 ...</span>
<span class="co">#  $ maxFsumz   : num [1:500, 1:2] 14.3 15.4 16.9 15.4 16.4 ...</span>
<span class="co">#  $ metricArray: num [1:164, 1:4, 1:500] 1 1 2 1 1 2 2 1 2 2 ...</span>
<span class="co">#  $ arguments  : Named num [1:10] 5 250 1 500 0 0 0.95 0.95 2 0</span></code></pre></div>
<p><code>summary(glades.titan)</code> provides similar output. The items within each <code>titan</code> object include:</p>
<ul>
<li><p><code>sppmax</code>- the taxon-specific result table described above</p></li>
<li><p><code>sumz.cp</code>- the community result table described above</p></li>
<li><p><code>env</code>- the environmental gradient, i.e. <code>glades.env</code></p></li>
<li><p><code>taxa</code>- the taxa matrix, i.e. <code>glades.taxa</code></p></li>
<li><p><code>envcls</code>- the environmental values used as candidate split points</p></li>
<li><p><code>srtEnv</code>- a sorted version of the environmental gradient</p></li>
<li><p><code>ivzScores</code> - a matrix containing <code>maxgrp</code>, <span class="math inline">\(z\)</span> scores, indVals, and <code>obsiv.prob</code> for each taxon</p></li>
<li><p><code>ivz</code> - sums of all taxa <code>z</code> scores belonging to <code>maxgrp = 1</code> or <code>maxgrp = 2</code> at each candidate split point along the environmental gradient</p></li>
<li><p><code>ivz.f</code> - sums of all pure and reliable taxa <span class="math inline">\(z\)</span> scores belonging to <code>maxgrp = 1</code> or <code>maxgrp = 2</code> at each candidate split point along the environmental gradient</p></li>
<li><p><code>maxSumz</code> - the environmental value corresponding to the unfiltered sum(z) maximum for each maxgrp and each bootstrap replicate</p></li>
<li><p><code>maxFsumz</code> - the environmental value corresponding to the filtered sum(z) maximum for each maxgrp and each bootstrap replicate</p></li>
<li><p><code>metricArray</code> - an array of summary metrics from the bootstrap based on ivzScores</p></li>
<li><p><code>arguments</code> - a list of arguments used in <code>titan()</code> function call</p></li>
</ul>
</div>
<div id="visualizing-results" class="section level3">
<h3>Visualizing Results</h3>
<div id="plot_sumz-and-plot_sumz_density" class="section level4">
<h4><code>plot_sumz()</code> and <code>plot_sumz_density()</code></h4>
<p>The community-level output may be viewed using the <code>plot_sumz()</code> or <code>plot_sumz_density()</code> functions. The <code>plot_sumz_density()</code> function is new to this version of <strong>TITAN2</strong>. We recommend its use because we think it will be both easier to understand than previous output and encourage appropriate interpretation of results.</p>
<p>There are many options for changing the look of the graphs; see their full documentations with <code>?plot_sumz</code> or <code>?plot_sumz_density</code>. An abbreviated version is presented below. To begin, here’s how you use <code>plot_sumz_density()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_sumz_density</span>(glades.titan)
<span class="co"># Error in plot_sumz_density(glades.titan): could not find function &quot;plot_sumz_density&quot;</span></code></pre></div>
<p><code>plot_sumz_density()</code> plots community level change identified with <strong>TITAN2</strong>. There are three component panels in the default output and we will consider them from the bottom to the top. The first plot is a slight modification of the original sum(z) plot first presented by Baker and King (2010). It shows the magnitude of change among taxa declining along the gradient (z-) and those increasing along the gradient. Peaks in the values indicate points along the environmental gradient that produce large amounts of change in community composition and/or structure. These are the nominal community change points. Plateaus denote regions of similar change. The sums are converted to areas using the logical argument <code>ribbon</code>, a line plot can be obtained by setting <code>ribbon</code> to FALSE, and the original point plot can be obtained by setting the logical argument <code>points</code> to TRUE.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_sumz_density</span>(glades.titan, <span class="dt">ribbon=</span><span class="ot">FALSE</span>, <span class="dt">points=</span><span class="ot">TRUE</span>)
<span class="co"># Error in plot_sumz_density(glades.titan, ribbon = FALSE, points = TRUE): could not find function &quot;plot_sumz_density&quot;</span></code></pre></div>
<p>The second change from earlier versions of <strong>TITAN2</strong> is that the logical argument <code>filter</code> defaults to TRUE. This argument ensures that the only taxa contributing to patterns in the sum(z) are pure and reliable taxa identified by the bootstrap results rather than all taxa. Setting <code>filter</code> to FALSE allows impure or unreliable taxa to contribute to apparent patterns of commuity change. In general, the filtered scores should show a similar pattern but be somewhat lower in magnitude depending on contributions from impure or unreliable taxa.</p>
<p>The middle panel shows the estimated probability density of the sum(z) across all bootstrap replicates. Previously these distributions were represented by cumulative frequency distributions of the sum(z) maxima. A narrow spread indicates a high degree of precison regarding the location of the community change point.</p>
<p>The top panel shows the observed sum(z-) and sum(z+) maxima as circles with the 95th percentile of their distributions as horzontal lines. The primary reason for this plot is to illustrate how much information is hidden by this technique relative to the probability density functions.</p>
<p>There are several additional plotting options in <code>plot_sumz_density()</code>. First, any of the three panels can be dropped by setting logical agruments <code>sumz</code>, <code>density</code>, or <code>change_points</code> to FALSE. Second, it is possible to display only the z- or z+ taxa through the use of the logical arguments <code>sumz1</code> and <code>sumz2</code>. Finally, the x axis label can be edited using the <code>xlabel</code> aregument.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_sumz_density</span>(glades.titan, <span class="dt">ribbon=</span><span class="ot">TRUE</span>, <span class="dt">points=</span><span class="ot">FALSE</span>, <span class="dt">sumz1=</span><span class="ot">FALSE</span>, <span class="dt">change_points =</span> <span class="ot">FALSE</span>, <span class="dt">xlabel=</span><span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Surface Water Total Phosphorus (&quot;</span><span class="op">*</span>mu<span class="op">*</span><span class="st">&quot;g/l)&quot;</span>)))
<span class="co"># Error in plot_sumz_density(glades.titan, ribbon = TRUE, points = FALSE, : could not find function &quot;plot_sumz_density&quot;</span></code></pre></div>
<p>Besides the mandatory titan object, arguments include:</p>
<ul>
<li><p><code>filter</code> - controls whether filtered (default) or unfiltered sum(z) scores are plotted</p></li>
<li><p><code>sumz</code> - logical whether sum(z) values are plotted</p></li>
<li><p><code>points</code> - logical whether point values of the sum(z) should be plotted</p></li>
<li><p><code>ribbon</code> - logical whether values of sum(z) should be plotted as a ribbon</p></li>
<li><p><code>density</code> - logical whether estimated probability densities should be plotted</p></li>
<li><p><code>change_points</code> - logical whether community change points should be plotted</p></li>
<li><p><code>sumz1</code> - logical whether sum(z) for <code>maxgrp = 1</code> should be plotted</p></li>
<li><p><code>sumz2</code> - logical whether sum(z) for <code>maxgrp = 2</code> should be plotted</p></li>
<li><p><code>xmin</code> - controls the x-axis minimum</p></li>
<li><p><code>xmax</code> - controls the x-axis maximum</p></li>
<li><p><code>xlabel</code> - text string for x-axis label</p></li>
<li><p><code>y1label</code> - text string for sum(z) y-axis, default labels are provided</p></li>
<li><p><code>y2label</code> - text string for density plot</p></li>
<li><p><code>alpha1</code> - controls the transparancy of sum(z-)</p></li>
<li><p><code>alpha2</code> - controls the transparancy of sum(z+)</p></li>
<li><p><code>col1</code> - color for `maxgrp = 1</p></li>
<li><p><code>col2</code> - color for `maxgrp = 2</p></li>
<li><p><code>axis_lab_size</code> - controls size of axis labels</p></li>
<li><p><code>legend.position</code> - controls location of legend</p></li>
</ul>
<p>For <code>plot_sumz</code>, the older plotting function in <strong>TITAN2</strong>, filled and hollow symbols denote the magnitude of summed z scores of increasing (z+) or decreasing (z-) taxa. Peaks in the values indicate points along the environmental gradient that produce large amounts of change in community composition and/or structure. Solid and dashed lines are cumulative frequency distributions of sum(z-) and sum(z+) maxima (respectively) across bootstrap replicates. Vertical CFDs indicate narrow uncertainty about where the maximum chnage occurs, sloping or stair-step CFDs suggest broad uncertainty regarding the location of maximum change.</p>
<p>Note that users can adjust colors (e.g. col1 and fil1) and labels for the left hand y-axis using the argument <code>y1label</code> or the x-axis with <code>xlabel</code>. Setting <code>filter = TRUE</code> will display the filtered sum(z) scores. In general, the filtered scores should show a similar pattern but be somewhat lower in magnitude depending on contributions from impure or unreliable taxa:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_sumz</span>(glades.titan, <span class="dt">filter =</span> <span class="ot">TRUE</span>)
<span class="co"># Error in plot_sumz(glades.titan, filter = TRUE): could not find function &quot;plot_sumz&quot;</span></code></pre></div>
<!-- Besides the mandatory titan object, arguments include: -->
<!-- - `filter` - controls whether filtered or unfiltered (default) sum(z) scores are plotted -->
<!-- - `cumfrq` - logical whether cumulative frequencies are plotted -->
<!-- - `bootz1` - logical whether cumulative frequencies for `maxgrp = 1` should be plotted -->
<!-- - `bootz2` - logical whether cumulative frequencies for `maxgrp = 2` should be plotted -->
<!-- - `sumz1` - logical whether sum(z) for `maxgrp = 1` should be plotted -->
<!-- - `sumz2` - logical whether sum(z) for `maxgrp = 2` should be plotted -->
<!-- - `xmin` - controls the x-axis minimum -->
<!-- - `xmax` - controls the x-axis maximum -->
<!-- - `xlabel` - text string for x-axis label -->
<!-- - `y1label` - text string for first y-axis, default labels are filtered or unfiltered sum(z) -->
<!-- - `y2label` - text string for second y-axis -->
<!-- - `log` - whether any axis should be log transformed for display (default is " ") -->
<!-- - `at` - controls coordinates of x-axis location -->
<!-- - `tck` - controls length and direction of tick marks; set to point -->
<!-- - `bty` - controls box type around plot; default = "u" -->
<!-- - `ntick` - number of tick marks to be plotted per axis -->
<!-- - `prtty` - controls whether `pretty()` is used to plot axis labels -->
<!-- - `dig` - controls number of decimal digits in axes -->
<!-- - `cex` - controls size of points in graph -->
<!-- - `cex.leg` - controls size of legend text/symbols -->
<!-- - `cex.lab` and cex.axis - control size of text on axes -->
<!-- - `leg.x - x` coordinate of legend -->
<!-- - `leg.y - y` coordinate of legend -->
<!-- - `legend` - logical whether legend should be plotted -->
<!-- - `pch1` - point symbols for `maxgrp = 1` -->
<!-- - `pch2` - point symbols for `maxgrp = 2` -->
<!-- - `col1` - color for `maxgrp = 1` -->
<!-- - `col2` - color for `maxgrp = 2` (unfilled) -->
</div>
<div id="plot_taxa_ridges" class="section level4">
<h4><code>plot_taxa_ridges()</code></h4>
<p>Pure (purity&gt;=0.95 or higher) and reliable (reliability&gt;=0.95 or higher) indicator taxa that contribute to the overall sum(z) scores can be plotted using the function <code>plot_taxa_ridges()</code>.</p>
<p>Taxa that meet purity (pur.cut) and reliability (rel.cut) criteria are extracted from the full taxa output object <code>titan.out$sppmax</code>, separated into two groups: z- (negative responders, or decliners) and z+ (positive responders, or increasers).</p>
<p>These two groups of negative and positive responders are arranged into separate, stacked panels for plotting. Within each panel, taxa change points (values of x resulting in the largest indicator z value) are visualized as a probability density function of the nBoot bootstrapped replicates (n=500 or however many nBoot replicates specified by the user).</p>
<p>Taxa names are arranged discretely along the y-axis based on the rank order of the central tendency of the probability density function for z- (negative, decliners) and z+ (positive, increasers), respectively.</p>
<p>There are many options for changing the look of the graph, so see the full documentation with <code>?plot_taxa_ridges</code>, but you can get started by simply calling <code>plot_taxa_ridges()</code> on the output of <code>titan()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_taxa_ridges</span>(glades.titan, <span class="dt">ytxt.sz=</span><span class="dv">8</span>)
<span class="co"># Error in plot_taxa_ridges(glades.titan, ytxt.sz = 8): could not find function &quot;plot_taxa_ridges&quot;</span></code></pre></div>
<p>Optional arguments include:</p>
<ul>
<li><p><code>z1</code> - logical whether <code>maxgrp = 1</code> taxa (z-, negative, decliners) should be plotted</p></li>
<li><p><code>z2</code> - logical whether <code>maxgrp = 2</code> taxa (z-, negative, decliners) should be plotted</p></li>
<li><p><code>z1_fill_low</code> - low value of the color fill gradient for z- (negative) taxa</p></li>
<li><p><code>z1_fill_high</code> - high value of the color fill gradient for z- (negative) taxa</p></li>
<li><p><code>z2_fill_low</code> - low value of the color fill gradient for z+ (positive) taxa</p></li>
<li><p><code>z2_fill_high</code> - high value of the color fill gradient for z+ (positive) taxa</p></li>
<li><p><code>pur.cut</code> - the purity value cutoff for selecting taxa for plotting (defaults to value selected in titan.out). We do not recommend selecting values less than 0.95 for purity; higher values up to 1.0 may be used to refine your selection to the purest responders in terms of direction.</p></li>
<li><p><code>rel.cut</code> - the reliability value cutoff for selecting taxa for plotting (defaults to value selected in titan.out). We do not recommend selecting values less than 0.95 for purity; higher values up to 1.0 may be used to refine your selection to the purest responders in terms of direction.</p></li>
<li><p><code>xlabel</code> - the x axis label; the default is “Environmental Gradient”</p></li>
<li><p><code>n_ytaxa</code> - the maximum number of taxa that can be plotted on the y-axes (combined between the two panels if both z1 and z2 = TRUE, or just for one panel if z1 or z2 = FALSE). If the total number of pure and reliable indicator taxa <em>exceeds</em> the value of n_ytaxa, then the function will select only the most pure and reliable taxa to match the value of n_ytaxa based on rank order of purity, reliability, and finally z.med (sequential sorting, respectively). The selection of n_ytaxa is independent of group membership, so that only the best indicators are displayed, regardless of z- or z+ grouping.</p></li>
<li><p><code>ytxt.sz</code> - size of the taxa labels on the y-axis. Defaults to ytxt.sz=10. Depending upon the height and width of the plot, labels may need to set to a smaller size to avoid overlap (e.g., see the plot above; here, ytxt.sz = 8).</p></li>
<li><p><code>printspp</code> - a logical determining whether the sppmax output for the plotted taxa is printed to the console; default = FALSE.</p></li>
<li><p><code>grid</code> - a logical determining whether gridlines are plotted; default=TRUE</p></li>
<li><p><code>xlim</code> - the upper and lower limits of the x-axis, e.g., xlim=c(0,180). The default is computed internally based on the lower and upper limits of the x variable.</p></li>
<li><p><code>bw</code> - short for “bandwidth”, it controls the degree of smoothing of the probability density plots. This is computed internally but can be adjusted manually using this argument. We strongly advise against changing this parameter from the default.</p></li>
</ul>
<p>Below is the same function with a user-specified x-label and n_ytaxa set to 50</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_taxa_ridges</span>(glades.titan, <span class="dt">xlabel =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Surface water total phosphorus (&quot;</span><span class="op">*</span>mu<span class="op">*</span><span class="st">&quot;g/l)&quot;</span>)), <span class="dt">n_ytaxa=</span><span class="dv">50</span>)
<span class="co"># Error in plot_taxa_ridges(glades.titan, xlabel = expression(paste(&quot;Surface water total phosphorus (&quot; * : could not find function &quot;plot_taxa_ridges&quot;</span></code></pre></div>
<p>There are a total of 90 pure and reliable indicator taxa in the <code>glades.titan</code> output, thus 40 taxa were excluded from this plot because we set <code>n_ytaxa = 50</code>. The 50 taxa plotted are the top 50 out of 90 taxa based on descending rank order of <code>purity</code>, <code>reliability</code>, and <code>z.median</code>, respectively.This argument can be useful when there are too many pure and reliable taxa to effectively visualize in one plot.</p>
<p>Alternatively, set <code>z1</code> or <code>z2 = FALSE</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_taxa_ridges</span>(glades.titan, <span class="dt">xlabel =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Surface water total phosphorus (&quot;</span><span class="op">*</span>mu<span class="op">*</span><span class="st">&quot;g/l)&quot;</span>)), <span class="dt">z2=</span><span class="ot">FALSE</span>)
<span class="co"># Error in plot_taxa_ridges(glades.titan, xlabel = expression(paste(&quot;Surface water total phosphorus (&quot; * : could not find function &quot;plot_taxa_ridges&quot;</span></code></pre></div>
<p>Gridlines are set to <code>TRUE</code> as the default, but can be removed if desired:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_taxa_ridges</span>(glades.titan, <span class="dt">xlabel =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Surface water total phosphorus (&quot;</span><span class="op">*</span>mu<span class="op">*</span><span class="st">&quot;g/l)&quot;</span>)), <span class="dt">z2=</span><span class="ot">FALSE</span>, <span class="dt">grid=</span><span class="ot">FALSE</span>)
<span class="co"># Error in plot_taxa_ridges(glades.titan, xlabel = expression(paste(&quot;Surface water total phosphorus (&quot; * : could not find function &quot;plot_taxa_ridges&quot;</span></code></pre></div>
</div>
<div id="plot_taxa" class="section level4">
<h4><code>plot_taxa()</code></h4>
<p>Pure and reliable indicator taxa change points can be plotted using an older plotting function that was integral to the original TITAN2 release, <code>plot_taxa()</code>. We have replaced this plot with the distributions in <code>plot_taxa_ridges()</code> because it tended to empahsize the observed change points over the bootrap replicates. Again, there are many options for changing the look of the graph, so see the full documentation with <code>?plot_taxa</code>, but you can get started by simply calling <code>plot_taxa()</code> on the output of <code>titan()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_taxa</span>(glades.titan, <span class="dt">xlabel =</span> <span class="st">&quot;Surface Water TP (ug/l)&quot;</span>)
<span class="co"># Error in plot_taxa(glades.titan, xlabel = &quot;Surface Water TP (ug/l)&quot;): could not find function &quot;plot_taxa&quot;</span></code></pre></div>
<p>Each plot includes robust declining taxa on the left axis, increasers on the right. Each observed change point (or median of bootstrap replicates if <code>z.med = TRUE</code>) is indicated by the circular symbol; the horizontal lines suggest 5-95% quantiles from the bootstrapped change point distribution.</p>
<p>Optional arguments include:</p>
<ul>
<li><p><code>z1</code> - logical whether <code>maxgrp = 1</code> taxa change points should be plotted</p></li>
<li><p><code>z2</code> - logical whether <code>maxgrp = 2</code> taxa change points should be plotted</p></li>
<li><p><code>interval</code> - logical whether 5%-95% quantile intervals should be plotted</p></li>
<li><p><code>prob95</code> - controls whether change point symbols are plotted at observed value or at quantile extremes, the extremes are useful for thinking about change from a risk perspective</p></li>
<li><p><code>z.med</code> - controls whether change point symbols are plotted at median of bootstrap replicates and using median <span class="math inline">\(z\)</span> score instead of observed value</p></li>
<li><p><code>cex.taxa</code> - controls size of taxon names in graph.</p></li>
</ul>
<p><code>log</code>, <code>at</code>, <code>xmin</code>, <code>xmax</code>, <code>xlabel</code>, <code>tck</code>, <code>bty</code>, <code>ntick</code>, <code>prtty</code>, <code>dig</code>, <code>leg.x</code>, <code>leg.y</code>, <code>cex</code>, <code>cex.axis</code>, <code>cex.leg</code>, <code>cex.lab</code>, <code>legend</code>, <code>col1</code>, <code>fil1</code>, <code>col2</code>, and <code>fil2</code> are the same as in <code>plot_sumz()</code> above.</p>
<p>Here is the same function with <code>z.med = TRUE</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_taxa</span>(glades.titan,<span class="dt">xlabel =</span> <span class="st">&quot;Surface Water TP (ug/l)&quot;</span>,<span class="dt">z.med =</span> T)
<span class="co"># Error in plot_taxa(glades.titan, xlabel = &quot;Surface Water TP (ug/l)&quot;, z.med = T): could not find function &quot;plot_taxa&quot;</span></code></pre></div>
<p>Alternatively, with <code>prob95 = TRUE</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_taxa</span>(glades.titan, <span class="dt">xlabel =</span> <span class="st">&quot;Surface Water TP (ug/l)&quot;</span>, <span class="dt">z.med =</span> F, <span class="dt">prob95 =</span> T)
<span class="co"># Error in plot_taxa(glades.titan, xlabel = &quot;Surface Water TP (ug/l)&quot;, z.med = F, : could not find function &quot;plot_taxa&quot;</span></code></pre></div>
<p>Importantly, some of the control over the plotting that was optional in the original version has been internalized and warnings are issued when users plot results without using the bootstrap results. Tables of significant z- and z+ taxa used to make graph are automatically returned but no longer automatically written as text files (these can be easily extracted from the <code>glades.titan$sppmax</code> table).</p>
</div>
<div id="plot_cps" class="section level4">
<h4><code>plot_cps()</code></h4>
<p>In <strong>TITAN2</strong> 2.0 and later, there are several plotting options; all contained within a single function centered on interpreting taxon-specific change points in the context of the results from the bootstrap resampling procedure.</p>
<ul>
<li><p><code>taxa.dist</code> - logical controls if taxon-specific change point distributions are plotted</p></li>
<li><p><code>z.weights</code> - logical controls if the median z-sore magnitude is used to weight the PDF from the distribution of resampled change points</p></li>
<li><p><code>taxaID</code> - if a number or name, creates a single taxon-specific abundance plot</p></li>
<li><p><code>cp.med</code> - logical controls if change point locations should be plotted using the median value across all bootstrap replicates instead of the observed value</p></li>
<li><p><code>cp.trace</code> - logical controls if IndVal and zscores are plotted for all candidate change points</p></li>
<li><p><code>cp.hist</code> - logical controls if histogram of change point PDF is plotted</p></li>
<li><p><code>stacked</code> - logical controls if change point PDFs for increasing and decreasing taxa are stacked or plotted separately</p></li>
</ul>
<p>The remaining arguments: <code>xlabel</code>, <code>xmin</code>, <code>xmax</code>, <code>tck</code>, <code>bty</code>, <code>ntick</code>, <code>cex</code>, <code>cex.axis</code>, <code>cex.leg</code>, <code>cex.lab</code>, <code>leg.x</code>, <code>leg.y</code> and <code>legend</code> are the same as in the previous plotting functions.</p>
<p>The default graphic from <code>plot_cps()</code> is a <span class="math inline">\(z\)</span>-score weighted probability density function derived from the empirical distribution of change points across all bootstrap replicates plotted as a histogram for each pure and reliable taxon (blue for decreasers and red for increasers). NOTE: When you try to plot the matrix of plots consecutively you can generate an error about “Figure margins too large”. This is easily addressed by closing the plot window, or turning the graphics device off.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_cps</span>(glades.titan)
<span class="co"># Error in plot_cps(glades.titan): could not find function &quot;plot_cps&quot;</span></code></pre></div>
<p>Typically, these histograms are visually scanned to distinguish those taxa whose bootstrapped change point distributions are clearly unimodal from those that are multimodal or more uniform. For any taxon of interest, a closer inspection can be achieved by setting the argument “taxaID” to a taxon ID number or label name. For example, in the plot above, if the declining (i.e., <code>maxgrp = 1</code>) taxon <code>&quot;ENALCIVI&quot;</code> is of interest, the user can set <code>taxaID = 57</code> or <code>taxaID = &quot;ENALCIVI&quot;</code> and either will produce the plot below. Again, you may need to close the plotting window or turn graphics off because we are switching plot margins.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_cps</span>(glades.titan, <span class="dt">taxaID =</span> <span class="st">&quot;ENALCIVI&quot;</span>, <span class="dt">xlabel =</span> <span class="st">&quot;Surface Water TP (ug/l)&quot;</span>)
<span class="co"># Error in plot_cps(glades.titan, taxaID = &quot;ENALCIVI&quot;, xlabel = &quot;Surface Water TP (ug/l)&quot;): could not find function &quot;plot_cps&quot;</span></code></pre></div>
<p>The base plot is simply taxon-specific abundance (black circles) along the environmental gradient. Overlaid near the top of the plot in red is the observed change point, or if <code>cp.med = TRUE</code>, the median change point across all bootstrap replicates. Overlaid on the abundance plot is the <span class="math inline">\(z\)</span>-weighted (if <code>z.weights = TRUE</code>) probability density function of change point locations across all bootstrap replicates (blue histogram). Setting <code>cp.hist = FALSE</code> will remove the histogram. On the other hand, setting <code>cp.trace = TRUE</code> will plot the observed IndVal <span class="math inline">\(z\)</span> scores (in red; what <strong>TITAN2</strong> uses by default if <code>imax = FALSE</code>) and the observed IndVal scores (in grey) for every candidate change point along the environmental gradient (see <a href="http://www.bioone.org/doi/abs/10.1899/12-142.1">Baker and King 2013</a> for examples):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_cps</span>(glades.titan, <span class="dt">taxaID =</span> <span class="st">&quot;ENALCIVI&quot;</span>, <span class="dt">cp.trace =</span> <span class="ot">TRUE</span>, <span class="dt">xlabel =</span> <span class="st">&quot;Surface Water TP (ug/l)&quot;</span>)
<span class="co"># Error in plot_cps(glades.titan, taxaID = &quot;ENALCIVI&quot;, cp.trace = TRUE, : could not find function &quot;plot_cps&quot;</span></code></pre></div>
<p>Below is an increasing taxon from the same data set with a conspicuously bimodal distribution of replicate change points:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_cps</span>(glades.titan, <span class="dt">taxaID =</span> <span class="st">&quot;OSTRASP5&quot;</span>, <span class="dt">cp.trace =</span> <span class="ot">TRUE</span>, <span class="dt">xlabel =</span> <span class="st">&quot;Surface Water TP (ug/l)&quot;</span>)
<span class="co"># Error in plot_cps(glades.titan, taxaID = &quot;OSTRASP5&quot;, cp.trace = TRUE, : could not find function &quot;plot_cps&quot;</span></code></pre></div>
<p>Here it appears as if two potential change points were predominantly identified: one that kept nearly all of the abundance to the right, and another (the observed) than kept nearly all the absences to the left.</p>
<p>Finally, if <code>taxa.dist = FALSE</code>, instead of a taxon-specific plot, <code>plot_cps()</code> will produce a plot of the summed <span class="math inline">\(z\)</span>-weighted (if <code>z.weights = TRUE</code>) probability densities across increasing (<code>maxgrp = 1</code>; blue) decreasing (<code>maxgrp = 2</code>; red) and all pure and reliable taxa (filter&gt;0; grey):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_cps</span>(glades.titan, <span class="dt">taxa.dist =</span> <span class="ot">FALSE</span>, <span class="dt">xlabel =</span> <span class="st">&quot;Surface Water TP (ug/l)&quot;</span>)
<span class="co"># Error in plot_cps(glades.titan, taxa.dist = FALSE, xlabel = &quot;Surface Water TP (ug/l)&quot;): could not find function &quot;plot_cps&quot;</span></code></pre></div>
<p>The accompanying table summarizes the location of both the <span class="math inline">\(z\)</span>-weighted and unweighted maxima along the environmental gradient, as well as the magnitude of those maxima for decreasing taxa (<code>maxgrp = 1</code>), increasing taxa (<code>maxgrp = 2</code>), and all pure and reliable taxa combined. In this case there appears to be good correspondence between the sum(z) maxima and the summed <span class="math inline">\(z\)</span>-weighted PDF maxima. In other words, the points at which community change appears to be greatest corresponds to where the sum of individual taxa changes tend to occur, even when different sets of observations are used. In practice, this is a desirable result we would expect to occur most of the time, yet exceptions to this pattern can also be informative. For example, in the plot above, there appears to be another candidate change point closer to ~10 ug/l where declining taxa tend to change frequently, and at both ~25 ug/l and ~40 ug/l there are large numbers of frequently occurring change points across both decliners and increasers even though they are not particularly large for either group by itself.</p>
<p>Alternatively, these different sums can be represented as a stacked bar chart by setting <code>stacked = TRUE</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_cps</span>(glades.titan, <span class="dt">taxa.dist =</span> <span class="ot">FALSE</span>, <span class="dt">xlabel =</span> <span class="st">&quot;Surface Water TP (ug/l)&quot;</span>, <span class="dt">stacked =</span> <span class="ot">TRUE</span>)
<span class="co"># Error in plot_cps(glades.titan, taxa.dist = FALSE, xlabel = &quot;Surface Water TP (ug/l)&quot;, : could not find function &quot;plot_cps&quot;</span></code></pre></div>
<p>Here the blue and red circles correspond to the location of the respective maxima for decreasing and increasing taxa change points. In either case, the summed PDFs are meant to provide complementarity to the <code>plot_sumz()</code> graphic about where there are key values along the environmental gradient where many coincident change points occur regardless of the sample.</p>
<p><strong>Citations:</strong></p>
<p><em>Baker, M.E. and R. S. King. 2010. A new method for detecting and interpreting biodiversity and ecological community thresholds. Methods in Ecology and Evolution 1: 25-43.Z</em></p>
<p><em>Baker, M.E. and R. S. King. 2013. Of TITAN and strawmen: an appeal for greater understanding of community data. Freshwater Science 32(2):489-506.</em></p>
<p><em>King, R.S. and C. J. Richardson. 2003. Integrating bioassessment and ecological risk assessment: an approach to developing numerical water-quality criteria. Environmental Management 31(6):795-809.</em></p>
<p><em>Dufrene, M. and P. Legendre. 1997. Species assemblages and indicator species: the need for a flexible asymmetrical approach. Ecological Monographs. 67:345-366.</em></p>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
